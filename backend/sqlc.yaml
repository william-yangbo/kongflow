version: '2'

# Multi-service SQLC configuration
# Supporting scalable service architecture for KongFlow

sql:
  # SecretStore Service - trigger.dev compatible
  - name: secretstore
    engine: 'postgresql'
    queries: './internal/secretstore/queries'
    schema: './db/migrations'
    gen:
      go:
        out: './internal/secretstore'
        package: 'secretstore'
        sql_package: 'pgx/v5'
        emit_json_tags: true
        emit_interface: true
        emit_prepared_queries: false
        emit_exact_table_names: true
        omit_unused_structs: true

  # ApiVote Service - trigger.dev ApiVoteService migration
  - name: apivote
    engine: 'postgresql'
    queries: './internal/apivote/queries'
    schema: './db/migrations'
    gen:
      go:
        out: './internal/apivote'
        package: 'apivote'
        sql_package: 'pgx/v5'
        emit_json_tags: true
        emit_interface: true
        emit_prepared_queries: false
        emit_exact_table_names: true
        omit_unused_structs: true

  # JobQueue Service - future trigger.dev job system
  # - name: jobqueue
  #   engine: 'postgresql'
  #   queries: './internal/jobqueue/queries'
  #   schema: './db/migrations'
  #   gen:
  #     go:
  #       out: './internal/jobqueue'
  #       package: 'jobqueue'
  #       sql_package: 'pgx/v5'
  #       emit_json_tags: true
  #       emit_interface: true
  #       emit_prepared_queries: false
  #       emit_exact_table_names: true

  # Workflow Service - future trigger.dev workflow system
  # - name: workflow
  #   engine: 'postgresql'
  #   queries: './internal/workflow/queries'
  #   schema: './db/migrations'
  #   gen:
  #     go:
  #       out: './internal/workflow'
  #       package: 'workflow'
  #       sql_package: 'pgx/v5'
  #       emit_json_tags: true
  #       emit_interface: true
  #       emit_prepared_queries: false
  #       emit_exact_table_names: true
